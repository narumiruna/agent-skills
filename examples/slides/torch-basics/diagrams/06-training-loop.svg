<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#0B1020"/>
      <stop offset="1" stop-color="#0A1634"/>
    </linearGradient>
    <filter id="shadow-sm" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="12" flood-color="#000000" flood-opacity="0.28"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="10" markerHeight="10" orient="auto-start-reverse">
      <path d="M0,0 L10,5 L0,10 z" fill="#A7B0C2"/>
    </marker>
    <style><![CDATA[
      .h1 { font-family: system-ui, -apple-system, "Segoe UI", Inter, "Noto Sans", sans-serif; font-size: 64px; font-weight: 760; letter-spacing: -0.4px; fill: #E7ECF5; }
      .body { font-family: system-ui, -apple-system, "Segoe UI", Inter, "Noto Sans", sans-serif; font-size: 26px; font-weight: 520; fill: #A7B0C2; }
      .kicker { font-family: system-ui, -apple-system, "Segoe UI", Inter, "Noto Sans", sans-serif; font-size: 22px; font-weight: 650; fill: #A7B0C2; letter-spacing: 0.3px; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 22px; fill: #E7ECF5; }
      .card { fill: #0F1730; stroke: #2B3558; stroke-width: 3; }
      .step { fill: #121A33; stroke: #2B3558; stroke-width: 3; }
      .edge { stroke: #A7B0C2; stroke-width: 3; marker-end: url(#arrow); }
    ]]></style>
  </defs>

  <rect width="1600" height="900" fill="url(#bg)"/>

  <g transform="translate(140 110)">
    <text class="kicker" x="0" y="0" dominant-baseline="hanging">PUTTING IT TOGETHER</text>
    <text class="h1" x="0" y="50" dominant-baseline="hanging">Training Loop</text>
    <text class="body" x="0" y="132" dominant-baseline="hanging">Forward pass, loss, backward, optimizer step (repeat)</text>
  </g>

  <g transform="translate(140 270)" filter="url(#shadow-sm)">
    <rect class="card" x="0" y="0" width="1320" height="520" rx="28"/>

    <g transform="translate(60 80)">
      <g transform="translate(0 0)">
        <rect class="step" x="0" y="0" width="300" height="90" rx="24"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">1. Batch</text>
        <text class="body" x="22" y="56" dominant-baseline="hanging">x, y</text>
      </g>

      <g transform="translate(340 0)">
        <rect class="step" x="0" y="0" width="320" height="90" rx="24"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">2. Forward</text>
        <text class="body" x="22" y="56" dominant-baseline="hanging">y_hat = model(x)</text>
      </g>

      <g transform="translate(700 0)">
        <rect class="step" x="0" y="0" width="320" height="90" rx="24"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">3. Loss</text>
        <text class="body" x="22" y="56" dominant-baseline="hanging">loss(y_hat, y)</text>
      </g>

      <g transform="translate(1040 0)">
        <rect class="step" x="0" y="0" width="220" height="90" rx="24"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">4. Backward</text>
        <text class="body" x="22" y="56" dominant-baseline="hanging">loss.backward()</text>
      </g>

      <line class="edge" x1="300" y1="45" x2="340" y2="45"/>
      <line class="edge" x1="660" y1="45" x2="700" y2="45"/>
      <line class="edge" x1="1020" y1="45" x2="1040" y2="45"/>

      <g transform="translate(0 150)">
        <rect class="step" x="0" y="0" width="520" height="100" rx="26" stroke="#EE4C2C"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">5. Optimizer step</text>
        <text class="body" x="22" y="60" dominant-baseline="hanging"><tspan class="mono">optimizer.step()</tspan> then <tspan class="mono">zero_grad()</tspan></text>
      </g>

      <g transform="translate(580 150)">
        <rect class="step" x="0" y="0" width="680" height="100" rx="26"/>
        <text class="body" x="22" y="22" dominant-baseline="hanging" fill="#E7ECF5">6. Repeat</text>
        <text class="body" x="22" y="60" dominant-baseline="hanging">Loop over batches for multiple epochs</text>
      </g>

      <line class="edge" x1="1110" y1="100" x2="1110" y2="150"/>
      <line class="edge" x1="1110" y1="250" x2="1110" y2="310"/>
      <path d="M1110 310 C1110 390 220 390 220 310" fill="none" stroke="#A7B0C2" stroke-width="3" marker-end="url(#arrow)"/>

      <g transform="translate(0 310)">
        <rect x="0" y="0" width="1260" height="130" rx="26" fill="#121A33" stroke="#2B3558" stroke-width="3"/>
        <text class="kicker" x="22" y="18" dominant-baseline="hanging">PRACTICAL NOTES</text>
        <text class="body" x="22" y="56" dominant-baseline="hanging">Use <tspan class="mono">model.train()</tspan> during training and <tspan class="mono">model.eval()</tspan> + <tspan class="mono">torch.no_grad()</tspan> for evaluation.</text>
        <text class="body" x="22" y="92" dominant-baseline="hanging">Keep tensors on the same device: <tspan class="mono">x.to(device)</tspan>, <tspan class="mono">model.to(device)</tspan>.</text>
      </g>
    </g>
  </g>
</svg>
